import{_ as X}from"./r7gvbwgk.js";import{_ as Y}from"./CUT5Z0q2.js";import{_ as Z}from"./D_S4Iaa4.js";import{_ as ee}from"./DX7fHSrm.js";import{_ as ae}from"./eZAZD6-_.js";import{_ as se}from"./C8daf2Og.js";import{J as te,K as oe,n as ne,s as le,B as re,r as c,o as x,c as A,a as l,b as u,w as T,u as s,H as B,I as M,x as ie}from"./-26k3Kfm.js";import{d as de,e as me,f as ce,g as ue}from"./DYk6i2Lg.js";import{c as f,r as R,e as pe,n as fe,m as _e,a as ve,u as he}from"./Dw3NAe37.js";import"./D81Fu6OS.js";import"./lPBNpYtl.js";const ge=te("usersStore",{state:()=>({}),actions:{async getUserList(r){try{return(await de(r)).data}catch(t){throw t}},async create(r){try{const t=await me(r);if(t.success)return t.data}catch(t){throw t}},async update(r){try{console.log(r.name);const t=await ce(r);if(t.success)return t.data}catch(t){throw t}},async delete(r){try{const t=await ue(r);if(t.success)return t.data}catch(t){throw t}}},persist:{storage:oe.localStorage}}),we={class:"w-full h-full pb-8 overflow-y-auto dark:text-gray-300"},be=l("div",{class:"text-gray-700 text-3xl"}," Users ",-1),ye={class:"mt-4 sm:mt-6"},xe={class:"flex justify-end"},De={class:"p-3 sm:p-5 mt-5 bg-white dark:bg-gray-800 rounded-[20px]"},Ue={class:"flex space-x-2"},$e=["onClick"],ke=["onClick"],Ce=["onClick"],Me={class:"modal-content p-4 md:p-5"},Pe={class:"col-span-2 mb-3"},Ve={class:"col-span-2 mb-3"},Ne={key:0,class:"col-span-2 mb-3"},Ae={key:1,class:"col-span-2"},qe={class:"flex items-center p-4 md:p-5 border-t border-gray-200 rounded-b dark:border-gray-600"},Je=ne({__name:"index",setup(r){const t=ge(),b=le(),{$toast:_}=ie();re(()=>{h()});const j=c([{title:"Name",value:"name"},{title:"Role",value:"role_name"},{title:"Email",value:"email"},{title:"Mobile No.",value:"mobile_no"},{title:"Type",value:"type"},{title:"Action",value:"action"}]),p=c([]),P=c(!1),v=c(!1),i=c(!1),q=c(""),E=c(),D=c({page:1,search:""}),d=c({name:"",email:"",mobile_no:"",password:""}),I={formData:{name:{required:f.withMessage("The Name field is required",R)},email:{required:f.withMessage("The Email field is required",(e,a)=>i.value||e?!0:a.message),email:f.withMessage("Please Enter a valid Email Address",pe)},mobile_no:{required:f.withMessage("The Mobile No field is required",R),numeric:f.withMessage("Please enter valid Mobile No.",fe),minLength:f.withMessage("Mobile no must be 10 letters",_e(10)),maxLength:f.withMessage("Mobile no must be 10 letters",ve(10))},password:{required:f.withMessage("The Password field is required",(e,a)=>i.value||e?!0:a.message)}}},o=he(I,{formData:d}),h=async()=>{await t.getUserList(D.value).then(e=>{p.value=e})},F=e=>{D.value.search=e,h()},H=e=>{let a=p.value.data[e].id;b.push(`/admin/users/${a}`)},G=e=>{i.value=!0;let a=p.value.data[e];d.value.name=a.name,d.value.id=a.id,d.value.mobile_no=a.mobile_no,v.value=!0},J=async()=>{if(await o.value.$validate())if(i.value){let a={name:d.value.name,id:d.value.id,mobile_no:d.value.mobile_no};t.update(a).then(m=>{v.value=!1,i.value=!1,h(),S()}).catch(m=>{L(m)})}else t.create(d.value).then(a=>{v.value=!1,h(),S()}).catch(a=>{L(a)})},L=e=>{var a,m,U,$,g,k,C,n,V,w,y;if(((a=e==null?void 0:e.response)==null?void 0:a.status)==422){let N=(U=(m=e==null?void 0:e.response)==null?void 0:m.data)==null?void 0:U.data;if(N){let Q=Object.keys(N)[0],W=N[Q];_.error(W[0],{duration:5e3})}else(g=($=e==null?void 0:e.response)==null?void 0:$.data)!=null&&g.success?_.error("something went wrong...!",{duration:5e3}):_.error((C=(k=e==null?void 0:e.response)==null?void 0:k.data)==null?void 0:C.message,{duration:5e3})}else(V=(n=e==null?void 0:e.response)==null?void 0:n.data)!=null&&V.success?_.error("something went wrong...!",{duration:5e3}):_.error((y=(w=e==null?void 0:e.response)==null?void 0:w.data)==null?void 0:y.message,{duration:5e3})},S=()=>{d.value={name:"",email:"",mobile_no:"",password:""},o.value.$reset()},K=e=>{var a;P.value=!0,q.value="upcoming",E.value=(a=p.value.data[e])==null?void 0:a.id},O=e=>{P.value=!1,e&&t.delete(E.value).then(a=>{(q.value="upcoming")?(h(),_.success("User Deleted successfully",{duration:5e3})):h()}).catch(a=>{_("error","Somthing went wrong",{duration:5e3})})},z=e=>{D.value.page=e,h()};return(e,a)=>{const m=X,U=Y,$=Z,g=ee,k=ae,C=se;return x(),A("div",we,[be,l("div",ye,[l("div",xe,[u(m,{onClick:a[0]||(a[0]=n=>v.value=!0),text:"Add User",class:"font-semibold w-fit mt-5"})]),l("div",De,[u(U,{title:"Users",isSearchable:!0,headings:s(j),onSearch:F,data:s(p).data},{action:T(({item:n,value:V,index:w})=>[l("div",Ue,[l("i",{class:"fas fa-pencil text-primary-400 cursor-pointer",onClick:y=>G(w)},null,8,$e),l("i",{class:"fas fa-eye text-blue-400 cursor-pointer",onClick:y=>H(w)},null,8,ke),l("i",{onClick:y=>K(w),class:"fas fa-trash text-red-400 cursor-pointer"},null,8,Ce)])]),_:1},8,["headings","data"]),s(p).total>10?(x(),B($,{key:0,class:"mt-4 flex justify-end",totalRecords:s(p).total,currentPage:s(D).page,recordsPerPage:s(p).per_page,onPageChange:z},null,8,["totalRecords","currentPage","recordsPerPage"])):M("",!0)])]),u(k,{title:s(i)?"Update User":"Add User",subTitle:"Confra will join and record the meeting",show:s(v),onClose:a[6]||(a[6]=n=>v.value=!1)},{default:T(()=>[l("div",Me,[l("div",Pe,[u(g,{id:"Name",label:"Name",name:"Name",type:"text",placeholder:"Name",icon:"fas fa-user",modelValue:s(o).formData.name.$model,"onUpdate:modelValue":a[1]||(a[1]=n=>s(o).formData.name.$model=n),errors:s(o).formData.name.$errors},null,8,["modelValue","errors"])]),l("div",Ve,[u(g,{id:"mobile_no",label:"Mobile No.",name:"mobile_no",type:"text",placeholder:"Mobile No.",icon:"fas fa-phone",modelValue:s(o).formData.mobile_no.$model,"onUpdate:modelValue":a[2]||(a[2]=n=>s(o).formData.mobile_no.$model=n),errors:s(o).formData.mobile_no.$errors},null,8,["modelValue","errors"])]),s(i)==!1?(x(),A("div",Ne,[u(g,{id:"Email",class:"mt-3",label:"Email",name:"email",type:"email",icon:"fas fa-envelope",placeholder:"Email",modelValue:s(o).formData.email.$model,"onUpdate:modelValue":a[3]||(a[3]=n=>s(o).formData.email.$model=n),errors:s(o).formData.email.$errors},null,8,["modelValue","errors"])])):M("",!0),s(i)==!1?(x(),A("div",Ae,[u(g,{id:"password",class:"mt-3",label:"Password",name:"password",type:"password",icon:"fas fa-eye",placeholder:"Password",modelValue:s(o).formData.password.$model,"onUpdate:modelValue":a[4]||(a[4]=n=>s(o).formData.password.$model=n),errors:s(o).formData.password.$errors},null,8,["modelValue","errors"])])):M("",!0)]),l("div",qe,[u(m,{class:"mr-2",text:s(i)?"Update":"Create",frontIcon:"fas fa-plus",onClick:J},null,8,["text"]),u(m,{text:"Cancel",onClick:a[5]||(a[5]=n=>v.value=!1),outline:""})])]),_:1},8,["title","show"]),s(P)?(x(),B(C,{key:0,onConfirmation:O})):M("",!0)])}}});export{Je as default};
