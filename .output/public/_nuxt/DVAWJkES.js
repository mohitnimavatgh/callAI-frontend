import{_ as W}from"./r7gvbwgk.js";import{_ as X}from"./CUT5Z0q2.js";import{_ as Y}from"./D_S4Iaa4.js";import{_ as Z}from"./DX7fHSrm.js";import{_ as ee}from"./eZAZD6-_.js";import{_ as ae}from"./C8daf2Og.js";import{J as se,K as te,n as oe,s as le,B as ne,r as c,o as y,c as E,a as i,b as p,w as A,u as s,H as B,I as P,x as re}from"./-26k3Kfm.js";import{F as ie,G as de,H as me,I as ue}from"./DYk6i2Lg.js";import{c as _,r as R,e as ce,n as pe,m as fe,a as _e,u as ve}from"./Dw3NAe37.js";import{u as ge}from"./Dq2eM7QD.js";import"./D81Fu6OS.js";import"./lPBNpYtl.js";const he=se("usersStore",{state:()=>({}),actions:{async getUserList(d){try{return(await ie(d)).data}catch(t){throw t}},async create(d){try{const t=await de(d);if(t.success)return t.data}catch(t){throw t}},async update(d){try{console.log(d.name);const t=await me(d);if(t.success)return t.data}catch(t){throw t}},async delete(d){try{const t=await ue(d);if(t.success)return t.data}catch(t){throw t}}},persist:{storage:te.localStorage}}),be={class:"w-full h-full pb-8 overflow-y-auto dark:text-gray-300"},we=i("div",{class:"text-gray-700 text-3xl"}," Users ",-1),ye={class:"mt-4 sm:mt-6"},xe={class:"flex justify-end"},Ue={class:"p-3 sm:p-5 mt-5 bg-white dark:bg-gray-800 rounded-[20px]"},De={class:"flex space-x-2"},$e=["onClick"],ke=["onClick"],Ce={class:"modal-content p-4 md:p-5"},Me={class:"col-span-2 mb-3"},Pe={class:"col-span-2 mb-3"},Ve={key:0,class:"col-span-2 mb-3"},Ne={key:1,class:"col-span-2"},qe={class:"flex items-center p-4 md:p-5 border-t border-gray-200 rounded-b dark:border-gray-600"},Je=oe({__name:"index",setup(d){const t=he();le();const o=ge(),{$toast:f}=re();ne(()=>{h()});const j=c([{title:"Name",value:"name"},{title:"Role",value:"role_name"},{title:"Email",value:"email"},{title:"Mobile No.",value:"mobile_no"},{title:"Type",value:"type"},{title:"Action",value:"action"}]),v=c([]),V=c(!1),g=c(!1),m=c(!1),L=c(""),S=c(),x=c({page:1,search:""}),r=c({name:"",email:"",mobile_no:"",password:""}),I={formData:{name:{required:_.withMessage("The Name field is required",R)},email:{required:_.withMessage("The Email field is required",(e,a)=>m.value||e?!0:a.message),email:_.withMessage("Please Enter a valid Email Address",ce)},mobile_no:{required:_.withMessage("The Mobile No field is required",R),numeric:_.withMessage("Please enter valid Mobile No.",pe),minLength:_.withMessage("Mobile no must be 10 letters",fe(10)),maxLength:_.withMessage("Mobile no must be 10 letters",_e(10))},password:{required:_.withMessage("The Password field is required",(e,a)=>m.value||e?!0:a.message)}}},l=ve(I,{formData:r}),h=async()=>{o.loading=!0,await t.getUserList(x.value).then(e=>{v.value=e,o.loading=!1}).catch(e=>{o.loading=!1,U(e)})},F=e=>{x.value.search=e,h()},H=e=>{m.value=!0;let a=v.value.data[e];r.value.name=a.name,r.value.id=a.id,r.value.mobile_no=a.mobile_no,r.value.email=a.email,g.value=!0},G=async()=>{if(await l.value.$validate())if(o.loading=!0,m.value){let a={name:r.value.name,id:r.value.id,mobile_no:r.value.mobile_no,email:r.value.email};t.update(a).then(u=>{g.value=!1,o.loading=!1,m.value=!1,h(),T(),f.success("User Updated Successfully",{duration:1e4})}).catch(u=>{o.loading=!1,U(u)})}else t.create(r.value).then(a=>{g.value=!1,o.loading=!1,h(),T(),f.success("User Created Successfully",{duration:1e4})}).catch(a=>{o.loading=!1,U(a)})},U=e=>{var a,u,D,$,b,k,C,n,N,w,M;if(((a=e==null?void 0:e.response)==null?void 0:a.status)==422){let q=(D=(u=e==null?void 0:e.response)==null?void 0:u.data)==null?void 0:D.data;if(q){let z=Object.keys(q)[0],Q=q[z];f.error(Q[0],{duration:5e3})}else(b=($=e==null?void 0:e.response)==null?void 0:$.data)!=null&&b.success?f.error("something went wrong...!",{duration:5e3}):f.error((C=(k=e==null?void 0:e.response)==null?void 0:k.data)==null?void 0:C.message,{duration:5e3})}else(N=(n=e==null?void 0:e.response)==null?void 0:n.data)!=null&&N.success?f.error("something went wrong...!",{duration:5e3}):f.error((M=(w=e==null?void 0:e.response)==null?void 0:w.data)==null?void 0:M.message,{duration:5e3})},T=()=>{r.value={name:"",email:"",mobile_no:"",password:""},l.value.$reset()},J=e=>{var a;V.value=!0,L.value="upcoming",S.value=(a=v.value.data[e])==null?void 0:a.id},K=e=>{V.value=!1,e&&(o.loading=!0,t.delete(S.value).then(a=>{o.loading=!1,(L.value="upcoming")?(h(),f.success("User Deleted successfully",{duration:5e3})):h()}).catch(a=>{o.loading=!1,U(a)}))},O=e=>{x.value.page=e,h()};return(e,a)=>{const u=W,D=X,$=Y,b=Z,k=ee,C=ae;return y(),E("div",be,[we,i("div",ye,[i("div",xe,[p(u,{onClick:a[0]||(a[0]=n=>g.value=!0),text:"Add User",class:"font-semibold w-fit mt-5"})]),i("div",Ue,[p(D,{title:"Users",isSearchable:!0,headings:s(j),onSearch:F,data:s(v).data},{action:A(({item:n,value:N,index:w})=>[i("div",De,[i("i",{class:"fas fa-pencil text-primary-400 cursor-pointer",onClick:M=>H(w)},null,8,$e),i("i",{onClick:M=>J(w),class:"fas fa-trash text-red-400 cursor-pointer"},null,8,ke)])]),_:1},8,["headings","data"]),s(v).total>10?(y(),B($,{key:0,class:"mt-4 flex justify-end",totalRecords:s(v).total,currentPage:s(x).page,recordsPerPage:s(v).per_page,onPageChange:O},null,8,["totalRecords","currentPage","recordsPerPage"])):P("",!0)])]),p(k,{title:s(m)?"Update User":"Add User",subTitle:"Confra will join and record the meeting",show:s(g),onClose:a[6]||(a[6]=n=>g.value=!1)},{default:A(()=>[i("div",Ce,[i("div",Me,[p(b,{id:"Name",label:"Name",name:"Name",type:"text",placeholder:"Name",icon:"fas fa-user",modelValue:s(l).formData.name.$model,"onUpdate:modelValue":a[1]||(a[1]=n=>s(l).formData.name.$model=n),errors:s(l).formData.name.$errors},null,8,["modelValue","errors"])]),i("div",Pe,[p(b,{id:"mobile_no",label:"Mobile No.",name:"mobile_no",type:"text",placeholder:"Mobile No.",icon:"fas fa-phone",modelValue:s(l).formData.mobile_no.$model,"onUpdate:modelValue":a[2]||(a[2]=n=>s(l).formData.mobile_no.$model=n),errors:s(l).formData.mobile_no.$errors},null,8,["modelValue","errors"])]),s(m)==!1?(y(),E("div",Ve,[p(b,{id:"Email",class:"mt-3",label:"Email",name:"email",type:"email",icon:"fas fa-envelope",placeholder:"Email",modelValue:s(l).formData.email.$model,"onUpdate:modelValue":a[3]||(a[3]=n=>s(l).formData.email.$model=n),errors:s(l).formData.email.$errors},null,8,["modelValue","errors"])])):P("",!0),s(m)==!1?(y(),E("div",Ne,[p(b,{id:"password",class:"mt-3",label:"Password",name:"password",type:"password",icon:"fas fa-eye",placeholder:"Password",modelValue:s(l).formData.password.$model,"onUpdate:modelValue":a[4]||(a[4]=n=>s(l).formData.password.$model=n),errors:s(l).formData.password.$errors},null,8,["modelValue","errors"])])):P("",!0)]),i("div",qe,[p(u,{class:"mr-2",text:s(m)?"Update":"Create",frontIcon:"fas fa-plus",onClick:G},null,8,["text"]),p(u,{text:"Cancel",onClick:a[5]||(a[5]=n=>g.value=!1),outline:""})])]),_:1},8,["title","show"]),s(V)?(y(),B(C,{key:0,onConfirmation:K})):P("",!0)])}}});export{Je as default};
